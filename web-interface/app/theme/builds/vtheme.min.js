const Background=function(){"use strict";function e(e){return e}function t(){}return{launch:function(){V.setNode("body",CanvasComponents.background())},draw:function(n){V.setPipe(e,t)(n)}}}(),Canvas=function(){"use strict";function e(){V.setStyle("font-styles",{"@font-face":{"font-family":"IBM Plex Regular",src:"url(/assets/font/IBMPlexSans-Regular.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"},"@font-face-2":{"font-family":"IBM Plex Medium",src:"url(/assets/font/IBMPlexSans-Medium.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"},"@font-face-3":{"font-family":"IBM Plex Bold",src:"url(/assets/font/IBMPlexSans-Bold.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"}})}function t(){V.setState("screen",{height:Number(window.innerHeight),width:Number(window.innerWidth),brandPrimary:V.getCss("--brandPrimary"),brandSecondary:V.getCss("--brandSecondary"),buttonBkg:V.getCss("--buttonBkg")}),V.setState("active",{}),V.setState("page",{height:V.getCss("--page-position-peek"),top:V.setPipe(V.getCss,V.castRemToPixel)("--page-position-top"),topSelected:V.setPipe(V.getCss,V.castRemToPixel)("--page-position-top-selected"),peek:V.getCss("--page-position-peek"),closed:V.getCss("--page-position-closed"),detach:V.setPipe(V.getCss,V.castRemToPixel)("--desktop-page-detach")});const e=V.getState();V.setState("page",{topCalc:e.screen.height-e.page.top-1.5*e.page.detach}),V.setState("page",{topSelectedCalc:e.screen.height-e.page.topSelected-1.5*e.page.detach}),V.setState("page",{featureCalc:Math.floor(e.screen.height-e.page.topSelected-9*(e.screen.width<600?e.screen.width:600)/16)}),V.setState("page",{featureDimensions:{width:e.screen.width<600?e.screen.width:495,height:Math.floor(9*(e.screen.width<600?e.screen.width:495)/16)}}),V.setState("header",{isHazed:!1,serviceNavTop:V.setPipe(V.getCss,V.castRemToPixel,Number)("--service-nav-top"),serviceNavLeft:V.getCss("--service-nav-left"),entityNavTop:V.getCss("--entity-nav-top"),entityNavLeft:V.getCss("--entity-nav-left")})}function n(){document.documentElement.style.setProperty("--screen-height",window.innerHeight+"px"),document.documentElement.style.setProperty("--screen-width",window.innerWidth+"px")}function o(){}function i(e,t=(e?e.path:"")){!function(){V.getState("serviceNav")||(Chat.launch(),Data.launch(),Marketplace.launch(),Media.launch(),User.launch());V.getSetting("demoContent")&&(async()=>{for(let e=0;e<DemoContent.mongoArr.length;e++)await V.setEntity(DemoContent.mongoArr[e])})()}(),V.getNode("background")||(Background.launch(),Haze.launch(),Feature.launch(),Header.launch(),Button.launch(),Page.launch()),function(){if(!V.getState("activeEntity")){const e=V.getCookie("last-active-address"),t=V.getCookie("last-active-uphrase");e?Join.draw("authenticate"):t?(async()=>{const e=await V.getEntity(V.castJson(t));V.setState("activeEntity",e.data[0]),Join.draw("new entity was set up")})():Join.launch()}}(),V.castRoute(t).then((e,t=e.status,n=e.data[0])=>{["home"].includes(t)?Marketplace.draw():["market","market category"].includes(t)?Marketplace.draw(n):["media","media category"].includes(t)?Media.draw(n):["data"].includes(t)?Data.draw(n):["user profile"].includes(t)?User.draw(n):["user account"].includes(t)?Account.draw(n):["user entities"].includes(t)?EntityList.draw(n):["user settings"].includes(t)?Settings.draw(n):["chat everyone"].includes(t)?Chat.draw(n):["profile"].includes(t)&&Profile.draw(n)})}return{launch:async function(){await async function(){V.getSetting("useBuilds")?(await Promise.all([V.setStylesheet("/css/builds/v.min.css")]),console.log("*** css builds loaded ***")):(await Promise.all([V.setStylesheet("/css/src/0_0_variables.css"),V.setStylesheet("/css/src/1_0_reset-normalize.css"),V.setStylesheet("/css/src/1_1_reset.css"),V.setStylesheet("/css/src/2_0_typography.css"),V.setStylesheet("/css/src/2_2_color.css"),V.setStylesheet("/css/src/3_0_utilities.css"),V.setStylesheet("/css/src/4_0_components.css"),V.setStylesheet("/css/src/8_0_overrides.css"),V.setStylesheet("/css/src/9_0_leaflet.css")]),console.log("*** css source files loaded ***"))}(),await async function(){V.getSetting("useBuilds")||(await Promise.all([V.setScript("/theme/src/canvas/components.js"),V.setScript("/theme/src/canvas/background.js"),V.setScript("/theme/src/canvas/haze.js"),V.setScript("/theme/src/canvas/feature.js"),V.setScript("/theme/src/canvas/header.js"),V.setScript("/theme/src/canvas/page.js"),V.setScript("/theme/src/modal/components.js"),V.setScript("/theme/src/modal/modal.js"),V.setScript("/theme/src/interaction/components.js"),V.setScript("/theme/src/interaction/button.js"),V.setScript("/theme/src/interaction/form.js"),V.setScript("/theme/src/interaction/join.js"),V.setScript("/theme/src/navigation/components.js"),V.setScript("/theme/src/navigation/navigation.js")]),console.log("*** theme source scripts loaded ***")),V.getSetting("useBuilds")?(await Promise.all([V.setScript("/plugins/builds/vplugins.min.js")]),console.log("*** plugins builds loaded ***")):(await Promise.all([V.setScript("/plugins/src/account/components.js"),V.setScript("/plugins/src/account/account.js"),V.setScript("/plugins/src/entity/components.js"),V.setScript("/plugins/src/entity/editable.js"),V.setScript("/plugins/src/entity/display.js"),V.setScript("/plugins/src/entity/settings.js"),V.setScript("/plugins/src/entity/entitylist.js"),V.setScript("/plugins/src/chat/components.js"),V.setScript("/plugins/src/chat/chat.js"),V.setScript("/plugins/src/map/map.js"),V.setScript("/plugins/src/google/google.js"),V.setScript("/plugins/src/data/components.js"),V.setScript("/plugins/src/data/data.js"),V.setScript("/plugins/src/marketplace/components.js"),V.setScript("/plugins/src/marketplace/marketplace.js"),V.setScript("/plugins/src/media/components.js"),V.setScript("/plugins/src/media/media.js")]),console.log("*** plugins source scripts loaded ***")),V.setNode("body",""),V.getSetting("demoContent")&&(await Promise.all([V.setScript("/assets/demo-content/demo-content.js")]),console.log("*** demo content loaded ***"))}(),V.setPipe(t,o,n,e)()},draw:function(e){(function(e){return Promise.resolve(e)})(e).then(e=>{i(e)})}}}(),CanvasComponents=function(){"use strict";return V.setStyle({"list > *:last-child":{"padding-bottom":"160px"},"card__top-left":{width:"25%"},"card__bottom-left":{display:"grid","justify-items":"center","text-align":"center",width:"25%"},"card__top-right":{width:"69%"},"card__bottom-right":{width:"69%"},card__unit:{width:"100%"},card__container:{"max-width":"360px","flex-wrap":"wrap"}}),{notFound:function(e){return V.setNode({t:"p",c:"pxy",h:V.i18n("No "+e+" found","app","not found")})},background:function(){return V.setNode({tag:"background",id:"background",classes:"background fixed w-screen",setStyle:{background:{background:"rgba(211,232,235,1)",height:"100vh","z-index":-2}}})},haze:function(){return V.setNode({tag:"haze",classes:"haze fixed w-screen bkg-white hidden",setStyle:{haze:{top:0,height:"45vh","z-index":-1}}})},feature:function(){const e=V.getState("page").featureDimensions;return V.setNode({tag:"feature",classes:"feature fixed hidden",setStyle:{feature:{top:"var(--page-position-top-selected)",height:e.height+"px",width:e.width+"px"}}})},balance:function(){const e=V.getState("screen");return V.setNode({tag:"balance",classes:"balance fixed cursor-pointer txt-anchor-mid",y:e.width>800?{top:"12px",left:"12px"}:{top:"2px",left:"2px"}})},interactions:function(){const e=V.getState("screen");return V.setNode({tag:"interactions",classes:"interactions fixed",setStyle:{interactions:{top:e.width>800?"23px":"11px",right:0,width:"45%"}},html:{tag:"ul",classes:"flex items-center justify-end"}})},handle:function(){return V.setNode({tag:"handle",classes:"handle",setStyle:{handle:{"padding-top":"12px",height:"26px",display:"block"}},html:{tag:"div",classes:"handle__bar rounded-full bkg-offblack",setStyle:{handle__bar:{"margin-left":"auto","margin-right":"auto",height:"4px",width:"5%","max-width":"40px"}}}})},topSlider:function(){return V.setNode({tag:"topslider"})},slider:function(){return V.castNode({tag:"slider",classes:"flex overflow-x-scroll list-none pb-s"})},listings:function(){return V.setNode({tag:"listings"})},list:function(e){const t=V.setNode({tag:"list",classes:"list flex flex-wrap content-start justify-evenly overflow-y-scroll list-none h-full"});return"narrow"==e&&(t.style["max-width"]="380px",t.style.margin="0 auto"),t},card:function(e,t){return V.setNode({t:"li",c:"pxy w-screen max-w-380",h:{t:"card",c:"card__container flex card-shadow rounded bkg-white pxy",h:t?[{t:"h2",c:"w-full font-bold pxy",h:V.i18n(t,"user profile","card title")},e]:e}})},header:function(){return V.setNode({tag:"header"})},page:function(){return V.setNode({tag:"page",classes:"page fixed w-screen bkg-white pill-shadow overflow-hidden",setStyle:{page:{bottom:0,height:"var(--page-position-peek)"}}})},content:function(){return V.setNode({tag:"content"})},topContent:function(){return V.setNode({tag:"topcontent"})}}}(),Feature=function(){"use strict";function e(e){return{$content:"object"==typeof e?e:e.content?e.content:void 0,fade:e.fade}}function t(e){const t=V.getNode("feature");"out"!=e.fade?("in"==e.fade||e.$content)&&(t.innerHTML="",V.setNode(t,e.$content),V.setAnimation("feature","fadeIn")):V.setAnimation("feature","fadeOut")}return{launch:function(){V.setNode("body",CanvasComponents.feature())},draw:function(n){V.setPipe(e,t)(n)}}}(),Haze=function(){"use strict";function e(e){return e}function t(e){if(e&&"out"==e.fade)return V.setState("header",{isHazed:!1}),void V.setAnimation("haze","fadeOut",{delay:.1,duration:1});1!=V.getState("header").isHazed&&(V.setState("header",{isHazed:!0}),V.setAnimation("haze","fadeIn",{delay:2,duration:3}))}return{launch:function(){V.setNode("body",CanvasComponents.haze())},draw:function(n){V.setPipe(e,t)(n)}}}(),Header=function(){"use strict";function e(e){return e}function t(){}return{launch:function(){const e=CanvasComponents.header(),t=CanvasComponents.balance(),n=NavComponents.entityNav(),o=NavComponents.userNav(),i=NavComponents.serviceNav(),a=CanvasComponents.interactions();V.setNode(e,[t,n,o,i,a]),V.setNode("body",e)},draw:function(n){V.setPipe(e,t)(n)}}}(),Page=function(){"use strict";const e={};function t(t){t&&(0!=t.reset&&(e.$topcontent.innerHTML="",e.$topslider.innerHTML="",e.$listings.innerHTML=""),t.topcontent&&V.setNode(e.$topcontent,t.topcontent),t.topslider&&V.setNode(e.$topslider,t.topslider),t.listings&&V.setNode(e.$listings,t.listings),t.position&&o(t.position,t.scroll,t.haze),t.pos&&o(t.pos,t.scroll,t.haze))}function n(e,t){V.setAnimation(".handle__bar",{width:e+"%"}),V.setAnimation("handle",{height:t+"px"})}function o(t,o,i){const a=V.getNode("list"),s=V.getNode("page"),r=V.getState("page"),c=V.getState("screen");"bottom"==o&&(a.scrollTop=a.scrollHeight);const l=function(e){const t=V.getState("page"),n=V.getState("active");switch(e){case"top":return n&&n.navItem?t.topSelectedCalc:t.topCalc;case"feature":return t.featureCalc;case"peek":return t.peek;default:return t.closed}}(t);l!=r.height&&(V.setAnimation(e.$page,{height:l+"px"},{duration:3}).then(()=>{a&&!o&&(a.scrollTop=0)}),"top"==t?(c.width<800&&(Haze.draw(),s.classList.remove("pill-shadow")),Feature.draw({fade:"out"}),n(7,22)):"feature"==t?(c.width<800&&s.classList.remove("pill-shadow"),c.width<800&&(null==i||0!=i)&&Haze.draw(),n(7,22),s.classList.remove("pill-shadow")):"closed"==t?(Haze.draw({fade:"out"}),Feature.draw({fade:"out"}),n(5,35),s.classList.add("pill-shadow")):"peek"==t&&(Haze.draw({fade:"out"}),Feature.draw({fade:"out"}),n(5,25),s.classList.add("pill-shadow")),V.setState("page",{height:l}))}return{launch:function(){!function(){const t=CanvasComponents.page(),n=CanvasComponents.handle(),o=CanvasComponents.content(),i=CanvasComponents.topContent(),a=CanvasComponents.topSlider(),s=CanvasComponents.listings();function r(e){V.setState("flick",{startX:e.changedTouches[0].clientX}),V.setState("flick",{startY:e.changedTouches[0].clientY})}function c(e){V.setState("flick",{endX:e.changedTouches[0].clientX}),V.setState("flick",{endY:e.changedTouches[0].clientY});const t=V.getNode("list");let n=!0;t&&t.scrollTop>0&&"listings"==e.currentTarget.localName&&(n=!1);const o=V.getState("page"),i=V.getState("flick");Math.abs(i.startX-i.endX)<100&&i.startY>i.endY+15?o.height==o.peek||o.height==o.featureCalc?Page.draw({position:"top",reset:!1}):o.height==o.closed&&Page.draw({position:"peek",reset:!1}):n&&Math.abs(i.startX-i.endX)<100&&i.startY<i.endY-15&&(o.height==o.peek?(Page.draw({position:"closed",reset:!1}),Navigation.draw()):(o.height==o.featureCalc||o.height>=o.topCalc)&&Page.draw({position:"peek",reset:!1}))}n.addEventListener("click",(function(){const e=V.getState("page");e.height==e.closed?Page.draw({position:"peek",reset:!1}):e.height==e.peek?Page.draw({position:"top",reset:!1}):(e.height==e.featureCalc||e.height>=e.topCalc)&&(Navigation.draw(),Page.draw({position:"closed",reset:!1}))})),n.addEventListener("touchstart",r),n.addEventListener("touchend",c),i.addEventListener("touchstart",r),i.addEventListener("touchend",c),a.addEventListener("touchstart",r),a.addEventListener("touchend",c),s.addEventListener("touchstart",r),s.addEventListener("touchend",c),V.setNode(o,[i,a,s]),V.setNode(t,[n,o]),V.setNode("body",t),e.$page=V.getNode("page"),e.$topcontent=V.getNode("topcontent"),e.$topslider=V.getNode("topslider"),e.$listings=V.getNode("listings")}()},draw:function(e){return Promise.resolve(t(e))}}}(),Button=function(){"use strict";function e(t){t.target.removeEventListener("click",e,!1);const n=V.getNode("form"),o=n.getNode("#plusform__loc"),i={title:n.getNode("#plusform__title").value,role:V.getNavItem("active","serviceNav").use.role,location:o.value,lat:o.value&&o.getAttribute("lat")||void 0,lng:o.value&&o.getAttribute("lng")||void 0,description:n.getNode("#plusform__descr").value,unit:n.getNode("#plusform__unit").value,target:n.getNode("#plusform__target").value};V.getState("activeAddress")&&Object.assign(i,{receivingAddress:V.getState("activeAddress")}),V.getState("activeEntity")?(V.setEntity(i).then(e=>{e.success?(console.log(e.status),V.setCache("all","clear"),V.setCache(e.data[0].profile.role,"clear"),V.setBrowserHistory(e.data[0].path),Profile.draw(e.data[0].path),Form.draw("all",{fade:"out"}),Button.draw("all",{fade:"out"}),VMap.draw({type:"Feature",geometry:e.data[0].geometry,profile:e.data[0].profile,thumbnail:e.data[0].thumbnail,path:e.data[0].path}),V.setEntity(V.getState("activeEntity").fullId,{field:"adminOf",data:e.data[0].fullId,auth:V.getCookie("last-active-uphrase").replace(/"/g,"")})):(Form.draw("error",e),console.error(e.status))}),V.setCookie("last-form",void 0)):(V.setCookie("last-form",i),Join.draw("authenticate"))}function t(){const e=V.getNode("#search-input").value;if(e.length<2)return;const t={query:e};Marketplace.draw(V.getState("active").navItem,t)}function n(){Form.draw("all",{fade:"out"}),Button.draw("all",{fade:"out"}),Button.draw(V.getNavItem("active","serviceNav").use.button,{delay:1.5}),Page.draw({position:"peek",reset:!1})}function o(){Page.draw({position:"closed",reset:!1}),Form.draw("search")}function i(){Page.draw({position:"closed",reset:!1}),Form.draw(V.getNavItem("active","serviceNav").use.form)}function a(){V.setBrowserHistory("/me/transfers"),V.setState("active",{lastViewed:V.getNode(".pill__replace").innerHTML}),Canvas.draw({path:"/me/transfers"})}return{launch:function(){!function(){const s=InteractionComponents.filter(),r=InteractionComponents.searchBtn(),c=InteractionComponents.query(),l=InteractionComponents.plus(),d=InteractionComponents.set(),u=InteractionComponents.sendNav(),p=InteractionComponents.close();l.addEventListener("click",i),r.addEventListener("click",o),p.addEventListener("click",n),c.addEventListener("click",t),d.addEventListener("click",e),u.addEventListener("click",a),V.setNode("interactions > ul",[p,l,s,r,c,d,u])}()},draw:function(e,t){!function(e){let t="fadeIn",n=.2;e.options&&"out"==e.options.fade&&(t="fadeOut"),e.options&&e.options.delay&&(n=e.options.delay),e.btnArr.forEach(e=>{V.setAnimation("#"+e,t,{delay:n,duration:.5})})}(function(e,t){return{btnArr:"all"==e?["filter","search","plus","close","set","send","query"]:e.split(" "),options:t}}(e,t))}}}(),InteractionComponents=function(){"use strict";const e="cursor-pointer hidden pr-s";function t(e){V.setNode("#img-upload__label",V.i18n("uploading...","form field","placeholder")),V.castImageUpload(e).then(e=>{V.setNode("#img-upload__label",V.i18n("Change","form field","placeholder")),V.setNode("#img-upload__preview",""),V.setNode("#img-upload__preview",V.cN({t:"img",y:{"max-width":"25px","max-height":"20px","margin-left":"10px"},src:e.src}))})}function n(e,t){return V.cN({t:"div",c:"circle-1 flex justify-center items-center rounded-full bkg-white transition"+(t?" "+t:""),h:V.getIcon(e)})}return{filter:function(){return V.cN({t:"li",id:"filter",c:e,h:n("filter_list")})},searchBtn:function(){return V.cN({t:"li",id:"search",c:e,h:n("search")})},query:function(){return V.cN({t:"li",id:"query",c:e,h:n("search")})},plus:function(){return V.cN({t:"li",id:"plus",c:e,h:n("+")})},close:function(){return V.cN({t:"li",id:"close",c:e,h:n("close")})},set:function(){return V.cN({t:"li",id:"set",c:e,h:n("send")})},sendNav:function(){return V.cN({t:"li",id:"send",c:e,h:n("send")})},sendBtn:function(){return V.cN({t:"button",i:"send-message",c:"circle-1 flex justify-center items-center rounded-full bkg-white",h:V.cN({t:"span",c:"sendbtn",s:{sendbtn:{position:"relative",left:"1px",top:"1px",opacity:"0.75"}},h:V.getIcon("send")})})},form:function(){return V.setNode({tag:"form",classes:"form fixed w-screen hidden bkg-white pxy",setStyle:{form:{"padding-top":"calc(var(--page-position-top-selected) + 5px) !important",height:"100%","z-index":-1}}})},formField:function(e,t,n,o){const i={uPhrase:{label:"Key",inputId:"loginform__uphrase",attributes:{type:"password",autocomplete:"off"}},title:{label:"Title",inputId:"plusform__title",attributes:{autocomplete:"off"}},location:{label:"Location",inputId:"plusform__loc",attributes:{value:t,lat:n,lng:o,autocomplete:"off"}},description:{label:"Description and Links",inputId:"plusform__descr",multiline:!0},target:{label:"Target",inputId:"plusform__target",fieldClasses:"w-1/3 inline-block"},unit:{label:"Unit",inputId:"plusform__unit",fieldClasses:"w-1/3 inline-block"},search:{label:"Search",inputId:"search-input"}};function a(){this.closest(".field").classList+=" field--static field--focus"}function s(){const e=this.closest(".field").classList;this.value||e.remove("field--static"),e.remove("field--focus")}const r=V.cN({t:"div",c:"field__input-container"}),c=V.cN({t:"div",c:"field__label-wrapper",h:{t:"label",c:"field__label label-primary",h:{t:"span",c:"label__content",h:i[e].label}}}),l=V.cN({t:"input",c:"field__input",id:i[e].inputId,e:{focus:a,blur:s},a:i[e].attributes||{value:t}}),d=V.cN({t:"textarea",c:"field__input auto-height",id:i[e].inputId,a:{row:"1"},h:t,e:{input:function(){this.style.height="1px",this.style.height=this.scrollHeight+"px"},focus:a,blur:s}});i[e].multiline?V.setNode(r,[c,d]):V.setNode(r,[c,l]);const u=i[e].fieldClasses||"",p=t?" field--static":"";return V.cN({t:"div",c:"field pxy "+u+p,h:{t:"div",c:"field__border",h:{t:"div",c:"field__internal",h:r}}})},formUploadImage:function(){return V.cN({t:"div",y:{padding:"16px","margin-left":"6px",display:"inline-flex","align-items":"center",position:"relative"},c:"field pxy w-30% border-shadow",h:[{t:"label",i:"img-upload__label",a:{for:"img-upload__file"},h:V.i18n("Image","form field","placeholder")},{t:"input",i:"img-upload__file",c:"hidden",a:{type:"file",accept:"image/*"},e:{change:t}},{t:"div",i:"img-upload__preview",y:{position:"absolute",right:"10px"}}]})},formSearchFilter:function(){return V.cN({t:"div",h:[{t:"p",c:"pxy",h:V.i18n("Enter a title or city name","app")}]})},joinBtn:function(){const e=V.getState("screen"),t="rgba("+e.buttonBkg+", 1)";return V.cN({t:"join",c:"fixed cursor-pointer txt-anchor-mid",y:e.width>800?{top:"12px",left:"12px"}:{top:"2px",left:"2px"},h:{tag:"svg",a:{width:e.width>800?"66px":"54px",viewBox:"0 0 36 36"},h:`<circle stroke-dasharray="100" transform ="rotate(-90, 18, 18) translate(0, 36) scale(1, -1)"\n                       stroke-dashoffset="-200" cx="18" cy="18" r="15.91549430918954" fill="${t}"\n                       stroke="${t}" stroke-width="2.7">\n                </circle>\n                <text class="font-medium fs-xs txt-button" x="50%" y="59%">Join</text>`}})},onboardingCard:function(){const e=V.getState("activeEntity"),t=V.getSetting("transactionLedger");if(e&&"EVM"==t){let t;const n=!!(e.balance&&e.balance.balance.liveBalance>0);return V.getState("activeAddress")?n||"member"!=e.profile.role?n&&"member"==e.profile.role?(t=V.castNode({tag:"div",c:"flex w-full items-center justify-evenly",html:"<p>👋 "+V.i18n("Verify with BrightID to receive VALUE basic income.","join","onboarding call to action")+"</p>"}),CanvasComponents.card(t)):"":(t=V.castNode({tag:"div",c:"flex w-full items-center justify-evenly",html:"<p>👋 "+V.i18n("Ask a friend to transfer 1 VALUE to progress your verification.","join","onboarding call to action")+"</p>"}),CanvasComponents.card(t)):(t=V.castNode({tag:"div",c:"flex w-full items-center justify-evenly",html:"<p>👋 "+V.i18n("Connect a crypto wallet","join","onboarding call to action")+"</p>"}),t.addEventListener("click",(function(){window.Web3Obj?Join.draw("authenticate existing entity"):Join.draw("install metamask")})),CanvasComponents.card(t))}return""}}}(),Form=function(){"use strict";return{draw:function(e,t){!function(e){if(e.fadeOut)V.getNode("form")&&V.setAnimation("form","fadeOut",{delay:.2,duration:1}).then(()=>{V.setNode("form","clear")});else if("invalid title"==e.status){const e=V.getNode("#plusform__title");e.setAttribute("placeholder",V.i18n("Please choose another title","placeholder","form error")),e.value="",e.className+=" border-error"}else if("could not attach geo data"==e.status){const e=V.getNode("#plusform__loc");e.setAttribute("placeholder",V.i18n("Could not attach geo data","placeholder","form error")),e.value="",e.className+=" border-error"}else V.setNode("body",e.$form),V.setAnimation("form","fadeIn",{delay:.2,duration:1}),Google.launch().then(()=>{Google.initAutocomplete("plusform")}),Button.draw("all",{fade:"out"}),Button.draw("search"==e.layout?"close query":"close set",{delay:1})}(function(e,t){if(t&&"out"==t.fade)return{fadeOut:!0};if("error"==e)return t;const n=InteractionComponents.form();if("new entity"==e){const e={title:void 0,role:void 0,location:void 0,lat:void 0,lng:void 0,description:void 0,unit:void 0,target:void 0},t=V.castJson(V.getCookie("last-form"));t&&(e.title=t.title,e.location=t.location,e.lat=t.lat,e.lng=t.lng,e.description=t.description,e.unit=t.unit,e.target=t.target),V.setNode(n,[InteractionComponents.formField("title",e.title),InteractionComponents.formField("location",e.location,e.lat,e.lng),InteractionComponents.formField("description",e.description),InteractionComponents.formField("target",e.target),InteractionComponents.formField("unit",e.unit),InteractionComponents.formUploadImage()])}else"search"==e?V.setNode(n,[InteractionComponents.formField("search"),InteractionComponents.formSearchFilter()]):V.setNode(n,[InteractionComponents.title(),InteractionComponents.desc()]);return{layout:e,$form:n}}(e,t))}}}(),Join=function(){"use strict";async function e(){const e=V.getState("activeAddress");return e?V.getEntity(e).then(async e=>{if(e.reset)return"entity not found";if(e.success){V.setState("activeEntity",e.data[0]);const t=await V.getEntityBalance(e.data[0]);return t.success?V.setState("activeEntity",{balance:{success:!0,balance:t.data[0]}}):V.setState("activeEntity",{balance:{success:!1,message:t.message.message.message}}),"entity found"}return"entity not found"}):"error"}return{launch:function(){if(!V.getNode("join")){V.setNode("balance > svg","clear"),V.setCookie("welcome-modal",1);const e=InteractionComponents.joinBtn();e.addEventListener("click",(function(){Join.draw("initialize join")})),V.setNode("header",e)}},draw:function(t){(async function(t){return window.Web3Obj&&"EVM"==V.getSetting("transactionLedger")?"initialize join"==t?t="initialize web3 join":t.includes("authenticate")?await V.setActiveAddress().then(async n=>{if(n.success){const n=await e();t.includes("existing entity")?(V.setCookie("welcome-modal",1),t="authenticate existing entity"):t=n}else t=n.status}):"new entity was set up"==t&&(V.getState("activeAddress")?t=await e():V.getState("activeEntity").fullId&&(t="entity found")):"Symbol"==V.getSetting("transactionLedger")?"initialize join"==t?t="web2 login":"new entity was set up"==t&&(V.setState("activeAddress",V.getState("activeEntity").symbolCredentials.address),t="entity found"):"initialize join"==t?t="initialize web2 join":"new entity was set up"==t&&(t="entity found"),t})(t).then(e=>{!function(e){if(console.log(e,new Date),Marketplace.draw(),"entity found"==e){V.setNode("join","clear");const t=V.getState("activeEntity").balance;t?t&&t.success?(Account.drawHeaderBalance(t.balance.balance),V.setNode(".modal","clear"),1==V.getCookie("welcome-modal")&&(Modal.draw(e),V.setCookie("welcome-modal",0))):Modal.draw("could not get balance"):(Account.drawHeaderBalance(),V.setNode(".modal","clear"),1==V.getCookie("welcome-modal")&&(Modal.draw(e),V.setCookie("welcome-modal",0)))}else"entity not found"==e?(V.sN("balance > svg","clear"),Join.launch(),Modal.draw(e)):"logged out"==e||"user denied auth"==e?(Join.launch(),Navigation.draw(),Modal.draw(e)):(Navigation.draw(),Page.draw({position:"closed"}),Modal.draw(e))}(e)})}}}(),ModalComponents=function(){"use strict";window.addEventListener("keydown",(function(e){const t=window.event?e.keyCode:e.which;V.getNode("#sign-transaction")&&13==t&&l(e)}));V.setStyle({modal:{top:"0",right:"0",bottom:"0",left:"0",background:"rgba(0,0,0,0.8)"},modal__content:{background:"white",width:"75vw","max-width":"500px",height:"46vh",margin:"14vh auto",padding:"0.5rem"},modal__close:{position:"absolute",right:"1rem",top:"1rem","text-decoration":"none",color:"white"},modal__uphrase:{color:"red"},"modal-pos-1":{top:"5vh"},"modal-pos-2":{top:"10vh"},"modal-pos-3":{top:"15vh"}});const e="relative bkg-button txt-button font-medium cursor-pointer txt-center pxy-1",t="relative cursor-pointer txt-center";function n(){V.setNode(".modal","clear")}function o(e){e.stopPropagation()}function i(){const t=InteractionComponents.formField("uPhrase"),n=V.cN({t:"div",c:e+" modal-pos-1",k:a,h:V.i18n("Use key","modal")});V.sN(".modal__content",""),V.setNode(".modal__content",[t,n])}function a(){V.getEntity(V.getNode("#loginform__uphrase").value).then(e=>{f(e)})}function s(){const t=InteractionComponents.formField("title"),n=V.cN({t:"div",c:e,k:r,h:V.i18n("Name profile","modal")}),o=V.sN({t:"div",c:"joinform__response pxy txt-red"});V.sN(".modal__content",""),V.setNode(".modal__content",[t,o,n])}function r(e){e.stopPropagation(),e.target.removeEventListener("click",r,!1),e.target.innerHTML=V.i18n("Joining ... ","modal"),V.getNode(".joinform__response").innerHTML="";const t={title:V.getNode("#plusform__title").value,role:"member",evmAddress:V.getState("activeAddress")};V.setState("activeEntity","clear"),console.log("about to set entity: ",t),V.setEntity(t).then(t=>{t.success?(console.log("response: ",t),V.setCache("all","clear"),f(t)):(console.log("response: ",t),e.target.addEventListener("click",r),e.target.innerHTML=V.i18n("Name profile","modal"),V.getNode(".joinform__response").innerHTML=t.message)})}function c(e){e.stopPropagation(),Join.draw("authenticate")}function l(e){if(e.stopPropagation(),e.target.removeEventListener("click",l,!1),V.getState("activeAddress")){const e=V.getNode("#sign-transaction");e.style.background="white",e.style.color="rgba("+V.getState("screen").brandSecondary+", 1)",e.innerHTML=V.i18n("Confirm in wallet ... ","modal")}const t=V.getState("active").transaction;V.setTransaction(t).then(e=>{e.success||(Modal.draw("error"),console.log(e))}).catch(e=>{console.error(e),Modal.draw()})}function d(){const e=V.getState("activeEntity"),t=V.getState("activeAddress");"EVM"==V.getSetting("transactionLedger")&&V.setEntity(e.fullId,{field:"evmCredentials.address",data:t,role:e.profile.role,auth:V.getCookie("last-active-uphrase").replace(/"/g,"")}).then(()=>{V.setEntity(e.fullId,{field:"receivingAddresses.evm",data:t,auth:V.getCookie("last-active-uphrase").replace(/"/g,"")}).then(()=>{Join.draw("authenticate")})})}function u(e){e.stopPropagation(),window.open("https://metamask.io/download.html","_blank")}function p(){V.setCookie("last-active-address","clear"),V.setCookie("last-active-uphrase","clear"),window.location.href="/"}function f(e){if(e.success)V.setState("activeEntity",e.data[0]),Join.draw("new entity was set up");else{const t=V.getNode("#loginform__uPhrase")||V.getNode("#plusform__title");t.value="",t.setAttribute("placeholder",V.i18n(e.status,"placeholder"))}}function g(){return V.cN({t:"div",c:"modal__content relative",k:o})}return{modal:function(){return V.cN({t:"modal",c:"modal fixed",h:{t:"div",c:"modal__close",h:(e="close",V.i18n(e,"modal components",t||"modal content")+" "),k:n},k:n});var e,t},modalContent:g,simpleMessage:function(e){const t=g(),n=V.cN({t:"p",h:V.i18n(e,"modal")});return V.setNode(t,n),t},getMetaMask:function(){const t=g(),n=V.cN({t:"p",c:"txt-center",h:V.i18n("Enable a crypto wallet in your browser, for example","modal")+' <a href="https://metamask.io/download.html" target="_blank">MetaMask</a>'}),o=V.cN({t:"div",c:"mt-r mb-r ml-auto mr-auto",y:{width:"108px"},h:{t:"img",src:"/assets/img/metamask-fox.png"}}),i=V.cN({t:"div",c:e,k:u,h:V.i18n("Get MetaMask","modal")});return V.setNode(t,[n,o,i]),t},confirmTransaction:function(t){const n=t.data[0],o=g(),i=V.cN({t:"p",c:"modal__p",h:`<p>Amount: ${n.amount}</p>\n      <p>Fee: ${n.feeAmount}</p>\n      <p>Contribution: ${n.contribution}</p>\n      <p>Total: ${n.txTotal}</p>`}),a=V.cN({t:"div",i:"sign-transaction",c:e+" modal-pos-1",k:l,h:V.i18n("Sign Transaction","modal")});return V.setNode(o,[i,a]),o},web3Join:function(){const n=g(),o=V.cN({t:"div",c:e+" modal-pos-1",k:c,h:V.i18n("Connect wallet","modal")}),a=V.cN({t:"p",c:t+" modal-pos-2",k:s,h:V.i18n("Name new profile only","modal")}),r=V.cN({t:"p",c:t+" modal-pos-3",k:i,h:V.i18n("Manage profile with key","modal")});return V.setNode(n,[o,a,r]),n},web2Join:function(){const n=g(),o=V.cN({t:"div",c:e+" modal-pos-1",k:s,h:V.i18n("Name new profile","modal")}),a=V.cN({t:"p",c:t+" modal-pos-2",k:i,h:V.i18n("Manage profile with key","modal")});return V.setNode(n,[o,a]),n},disconnect:function(){const t=g(),n=V.cN({t:"div",c:e+" modal-pos-1",k:p,h:V.i18n("Confirm Disconnect","modal")});return V.setNode(t,n),t},mapAddress:function(){const n=g(),o=V.cN({t:"div",c:e+" modal-pos-1",k:d,h:V.i18n("Use current profile","modal")}),i=V.cN({t:"p",c:t+" modal-pos-2",k:s,h:V.i18n("Name new profile","modal")});return V.setNode(n,[o,i]),n},entityFound:function(e,t,n){const o=g(),i=V.cN({t:"div",c:"txt-center pxy",h:[{t:"p",h:V.i18n("Welcome","modal")},{t:"p",c:"font-medium fs-l pxy",h:e.fullId}]}),a=V.cN({t:"div",c:"txt-center",h:[{t:"p",c:"pxy",h:V.i18n("Click to copy the key and store it safely elsewhere","modal")},UserComponents.caseUphraseNode(e.private.uPhrase,"txt-red fs-l"),{t:"p",c:"pxy",h:V.i18n("You'll need this key to manage this profile","modal")}]});let s;const r=e.balance;return s=r?V.cN({t:"p",c:"modal__details",h:`\n        ${n} ${V.i18n("Live Balance","modal")}: ${r.liveBalance}<br>\n        ${t}: ${r.coinBalance}<br>\n        `}):V.cN({t:"p",h:V.i18n("Sorry, account details could not be retrieved","modal")}),V.setNode(o,[i,a]),o},entityNotFound:function(){const n=g(),o=V.cN({t:"div",c:e+" modal-pos-1",k:s,h:V.i18n("Name new profile","modal")}),i=V.cN({t:"p",c:t+" modal-pos-2",k:d,h:V.i18n("Use active profile","modal")}),a=V.cN({t:"p",c:"modal-pos-3 relative txt-center",h:V.i18n("Naming your profile creates a new entity for your address. An entity can be anything you want to make visible in the network.","modal")});return V.getState("activeEntity")?V.setNode(n,[o,i,a]):V.setNode(n,[o,a]),n}}}(),Modal=function(){"use strict";return{draw:function(e){!function(e){const t=ModalComponents.modal();if("entity found"==e){const e=V.getState("activeEntity"),n=V.getSetting("coinTicker"),o=V.getSetting("tokenTicker");V.setNode(t,ModalComponents.entityFound(e,n,o))}else if("entity not found"==e)V.setNode(t,ModalComponents.entityNotFound());else if("authenticate existing entity"==e)V.setNode(t,ModalComponents.mapAddress());else if("web3 provider not found"==e)V.setNode(t,ModalComponents.tempUser());else if("initialize web3 join"==e)V.setNode(t,ModalComponents.web3Join());else if("initialize web2 join"==e)V.setNode(t,ModalComponents.web2Join());else if("user denied auth"==e)V.setNode(t,ModalComponents.simpleMessage("Could not unlock wallet"));else if("could not get balance"==e)V.setNode(t,ModalComponents.simpleMessage("Could not get account balance. Is the network set correctly in your wallet? <br><br>Please set to KOVAN."));else if("wallet locked"==e)V.setNode(t,ModalComponents.simpleMessage("Connecting your wallet ... Seeing this message for long? You may have to unlock it manually. For example when using the MetaMask wallet."));else if("logged out"==e)V.setNode(t,ModalComponents.simpleMessage("You are logged out"));else if("disconnect"==e)V.setNode(t,ModalComponents.disconnect());else if("install metamask"==e)V.setNode(t,ModalComponents.getMetaMask());else if("please wait"==e)V.setNode(t,ModalComponents.simpleMessage("Please wait... requesting data"));else if("confirm transaction"==e){const e=V.getState("active").transaction;V.setNode(t,ModalComponents.confirmTransaction(e))}else"transaction sent"==e?(V.setNode(t,ModalComponents.simpleMessage("Transaction has been sent to the network")),setTimeout(()=>{V.setNode(".modal","clear")},1800)):"transaction successful"==e?V.setNode(t,ModalComponents.simpleMessage("Transaction successful")):V.setNode(t,ModalComponents.simpleMessage("An error occured"));V.setNode(".modal","clear"),V.setNode("body",t)}(e)}}}(),NavComponents=function(){"use strict";V.setStyle({pill:{height:"2.5rem",padding:"0 1.2rem","margin-right":"0.7rem"},pill__entity:{height:"2.5rem",padding:"0 1rem","margin-right":"0.7rem"},"pill--selected":{color:"rgba(var(--brandPrimary), 1)",border:"2px solid rgba(var(--brandPrimary), 1)"},"pill--user-online":{position:"relative",left:"-3px"},pill__placeholderimage:{position:"relative",bottom:"-5px"},pill__img:{position:"relative",left:"-10px",border:"2px solid white"},pill__initials:{position:"relative",right:"3px"},"entity-nav":{"padding-top":"4px","padding-bottom":"8px",top:"var(--entity-nav-top)",left:"var(--entity-nav-left)"},"user-nav":{"padding-top":"4px","padding-bottom":"8px",top:"var(--user-nav-top)",left:"var(--user-nav-left)",display:"none"},"service-nav":{"padding-top":"4px","padding-bottom":"28px",top:"var(--service-nav-top)",left:"var(--service-nav-left)"},"entity-nav__ul":{"padding-left":"3px"},"service-nav__ul":{"padding-left":"3px"},"user-nav__ul":{"padding-left":"3px"},"entity-nav__ul > *:last-child":{visibility:"hidden"},"service-nav__ul > *:last-child":{visibility:"hidden"},"user-nav__ul > *:last-child":{visibility:"hidden"}});return{pill:function(e){return V.cN({t:"li",c:"pill flex justify-center items-center rounded-full bkg-white pill-shadow cursor-pointer no-txt-select whitespace-no-wrap",a:{path:e.path||"/"},h:[{t:"span",h:V.i18n(e.title,"navigation","nav item")}]})},entityPill:function(e){const t=(e=>{const t=["rgba("+V.getState("screen").brandSecondary+", 1)"];if(e.tinyImage){return"url('"+V.castEntityThumbnail(JSON.parse(e.tinyImage)).src+"')"}return t[0]})(e);return V.cN({t:"li",c:(e.tinyImage?"pill__entity":"pill")+" flex justify-center items-center rounded-full bkg-white pill-shadow cursor-pointer no-txt-select whitespace-no-wrap",a:{path:e.path||"/",fullId:e.title+" "+e.tag,initials:e.initials},h:[{t:"div",c:"pill__img circle-0 rounded-full flex justify-center items-center cursor-pointer",a:{style:`background:${t}; background-position: center center; background-size: cover;`},h:{t:"div",c:"card__initials font-bold fs-s txt-white",h:t.includes("url")?"":'<svg class="pill__placeholderimage txt-white" xmlns="http://www.w3.org/2000/svg" height="30" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4z"/></svg>'}},{t:"span",c:"pill__initials",h:V.i18n(e.initials,"navigation","nav item")}]})},entityNav:function(){return V.cN({t:"entity-nav",c:"nav entity-nav fixed w-screen overflow-x-scroll"})},userNav:function(){return V.cN({t:"user-nav",c:"nav user-nav fixed w-screen overflow-x-scroll"})},serviceNav:function(){return V.cN({t:"service-nav",c:"nav service-nav fixed w-screen overflow-x-scroll"})},entityNavUl:function(){return V.cN({t:"ul",c:"entity-nav__ul flex items-center font-medium fs-rr"})},serviceNavUl:function(){return V.cN({t:"ul",c:"service-nav__ul flex items-center font-medium"})},userNavUl:function(){return V.cN({t:"ul",c:"user-nav__ul flex items-center font-medium"})}}}(),Navigation=function(){"use strict";function e(e){if(e.success){!e.data[0].which&&s();const n=NavComponents.serviceNavUl();n.addEventListener("click",o);const i=t(e.data[0].serviceNav,3);for(let e=0;e<i.length;e++){const t=NavComponents.pill(i[e]);V.setNode(n,t)}V.setNode(n,NavComponents.pill({title:""})),V.setNode("service-nav",""),V.setNode("service-nav",n);const a=NavComponents.entityNavUl();a.addEventListener("click",o);const r=t(e.data[0].entityNav,3);for(let e=0;e<r.length;e++){const t=NavComponents.entityPill(r[e]);V.setNode(a,t)}V.setNode(a,NavComponents.pill({title:"zzzzz"})),V.setNode("entity-nav",""),V.setNode("entity-nav",a);const c=NavComponents.userNavUl();c.addEventListener("click",o);const l=t(e.data[0].userNav,1);for(let e=0;e<l.length;e++){const t=NavComponents.pill(l[e]);V.setNode(c,t)}V.setNode(c,NavComponents.pill({title:"zzzzz"})),V.setNode("user-nav",""),V.setNode("user-nav",c)}const n=e.data[0].which;n&&function(e){const t=V.getNode('[path="'+e+'"]');V.setState("active",{navItem:t.getAttribute("path")});const n=t.closest(".nav"),o=n.localName;"user-nav"==o||V.getVisibility("entity-nav")||(n.style.display="block",V.setAnimation("user-nav","fadeOut",{duration:.1}),V.setAnimation("entity-nav","fadeIn",{duration:.2}),V.setAnimation("service-nav","fadeIn",{duration:.6}));"user-nav"!=o||V.getVisibility("user-nav")||(n.style.display="block",V.setAnimation("entity-nav","fadeOut",{duration:.1}),V.setAnimation("service-nav","fadeOut",{duration:.6}),V.setAnimation("user-nav","fadeIn",{duration:.2}));const s=V.getState("header");i(),function(e){const t=e.getElementsByClassName("pill__initials")[0];t&&(t.innerHTML=e.getAttribute("fullId"),t.previousSibling.style.display="none",t.classList.add("pill__replace"),t.classList.remove("pill__initials"));e.className+=" pill--selected",e.addEventListener("click",a,{once:!0})}(t);const r=t.getBoundingClientRect();(function(e,t,n,o){let i=" absolute font-medium";"entity-nav"==e&&(i+=" fs-rr");const a=t.cloneNode(!0);a.className+=i,a.style.left=n.left+"px",a.style.top=n.top+"px",V.getNode("body").appendChild(a),t.style.visibility="hidden",V.getNode(e+" > ul").prepend(t),V.setAnimation(a,{top:o.entityNavTop+4,left:o.entityNavLeft+3},{duration:2}).then(()=>{t.style.visibility="visible",a.remove()})})(o,t,r,s),function(e){const t=V.getNode(e+" > ul").childNodes,n=V.castJson(V.getCookie(e+"-order"));for(let e=0;e<t.length-1;e++){const o=t[e],i=o.getAttribute("path");o.classList.contains("pill--selected")&&(n[i].c?n[i].c+=1:n[i].c=1),n[i].l=e}V.setCookie(e+"-order",n)}(o);const c="service-nav"==o?"entity-nav":"service-nav";V.sA(c,{width:0},{duration:1}),V.setAnimation(o,{width:r.width+11,top:s.entityNavTop,left:s.entityNavLeft},{duration:1}),V.getNode(o).scrollLeft=0}(n)}function t(e,t){const n=Object.values(e).sort((function(e,t){return e.l-t.l})),o=n.slice(t).sort((function(e,t){return t.c-e.c}));return n.slice(0).splice(0,t).concat(o)}function n(e,t){for(const n in e)t.hasOwnProperty(n)||delete e[n];for(const n in t)e.hasOwnProperty(n)||(e[t[n].path]={title:t[n].title,tag:t[n].tag,initials:t[n].initials,path:t[n].path},t[n].tinyImage&&(e[t[n].path].tinyImage=t[n].tinyImage))}function o(e){e.stopPropagation();const t=e.target.closest("li");if(t){const e=t.getAttribute("path");V.setState("active",{navItem:e}),V.setBrowserHistory(e),V.getNavItem("active",["serviceNav","entityNav","userNav"]).draw(e)}}function i(){const e=document.getElementsByClassName("pill--selected");if(e.length)for(let t=0;t<e.length;t++){const n=e[t].getElementsByClassName("pill__replace")[0];n&&(n.innerHTML=e[t].getAttribute("initials"),n.previousSibling.style.display="flex",n.classList.add("pill__initials"),n.classList.remove("pill__replace")),e[t].removeEventListener("click",a),e[t].classList.remove("pill--selected")}}function a(e){e.stopPropagation(),s(),Page.draw({position:"closed",reset:!1})}function s(){const e=V.getState("header"),t=window.innerWidth;i(),Chat.drawMessageForm("clear"),V.setBrowserHistory("/"),V.getVisibility("user-nav")&&(V.setAnimation("user-nav","fadeOut",{duration:.1}).then(()=>{V.setAnimation("user-nav",{width:t})}),V.setAnimation("entity-nav","fadeIn",{duration:.2}),V.setAnimation("service-nav","fadeIn",{duration:.6})),V.setState("active",{navItem:!1}),V.getNode("entity-nav").scrollLeft=0,V.getNode("service-nav").scrollLeft=0,V.setAnimation("entity-nav",{width:t},{duration:1.5}),V.setAnimation("service-nav",{width:t,top:e.serviceNavTop,left:e.serviceNavLeft},{duration:2.5}),Form.draw("all",{fade:"out"}),Button.draw("all",{fade:"out"})}return{draw:function(t){e(function(e,t=("object"==typeof e?e.paths.entity:e)){const o=V.castJson(V.getCookie("entity-nav-order")||"{}");!V.getState("entityNav")&&V.setState("entityNav",{});const i=V.getState("entityNav");e&&e.tinyImage&&o[e.path]&&(o[e.path].tinyImage=JSON.stringify(e.tinyImage));for(const e in o)if(!i[e]){const t={title:o[e].title,tag:o[e].tag,initials:o[e].initials,path:o[e].path,draw:function(e){Profile.draw(e)}};o[e].tinyImage&&(t.tinyImage=o[e].tinyImage),V.setNavItem("entityNav",t)}if(e&&e.fullId&&!i[e.path]){const t={title:e.profile.title,tag:e.profile.tag,initials:V.castInitials(e.profile.title),path:e.path,draw:function(e){Profile.draw(e)}};e.tinyImage&&(t.tinyImage=JSON.stringify(e.tinyImage)),V.setNavItem("entityNav",t)}n(o,i),V.setCookie("entity-nav-order",o);const a=V.getNode('[path="'+t+'"]');if(a&&a.closest("header")&&!e.fullId)return{success:!1,status:"navigation does not need updating",data:[{which:t}]};const s=V.castJson(V.getCookie("service-nav-order")||"{}");n(s,V.getState("serviceNav")),V.setCookie("service-nav-order",s);const r=V.castJson(V.getCookie("user-nav-order")||"{}");return n(r,V.getState("userNav")),V.setCookie("user-nav-order",r),{success:!0,status:"navigation updated",data:[{which:t,entityNav:o,userNav:r,serviceNav:s,keep:5}]}}(t))}}}();