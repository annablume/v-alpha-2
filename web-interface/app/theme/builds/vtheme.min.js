const Background=function(){"use strict";function t(t){return t}function e(){}return{launch:function(){V.setNode("body",CanvasComponents.background())},draw:function(n){V.setPipe(t,e)(n)}}}(),Canvas=function(){"use strict";function t(){V.setStyle("font-styles",{"@font-face":{"font-family":"IBM Plex Regular",src:"url(/assets/font/IBMPlexSans-Regular.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"},"@font-face-2":{"font-family":"IBM Plex Medium",src:"url(/assets/font/IBMPlexSans-Medium.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"},"@font-face-3":{"font-family":"IBM Plex Bold",src:"url(/assets/font/IBMPlexSans-Bold.ttf) format('truetype')","font-display":"fallback","unicode-range":"U+000-024F"}})}function e(){V.setState("screen",{height:Number(window.innerHeight),width:Number(window.innerWidth),brandPrimary:V.getCss("--brandPrimary"),brandSecondary:V.getCss("--brandSecondary"),buttonBkg:V.getCss("--buttonBkg")}),V.setState("active",{}),V.setState("page",{height:V.getCss("--page-position-peek"),top:V.setPipe(V.getCss,V.castRemToPixel)("--page-position-top"),topSelected:V.setPipe(V.getCss,V.castRemToPixel)("--page-position-top-selected"),peek:V.getCss("--page-position-peek"),closed:V.getCss("--page-position-closed"),detach:V.setPipe(V.getCss,V.castRemToPixel)("--desktop-page-detach")});const t=V.getState();V.setState("page",{topCalc:t.screen.height-t.page.top-1.5*t.page.detach}),V.setState("page",{topSelectedCalc:t.screen.height-t.page.topSelected-1.5*t.page.detach}),V.setState("page",{featureCalc:Math.floor(t.screen.height-t.page.topSelected-9*(t.screen.width<600?t.screen.width:600)/16)}),V.setState("page",{featureDimensions:{width:t.screen.width<600?t.screen.width:495,height:Math.floor(9*(t.screen.width<600?t.screen.width:495)/16)}}),V.setState("header",{isHazed:!1,serviceNavTop:V.setPipe(V.getCss,V.castRemToPixel,Number)("--service-nav-top"),serviceNavLeft:V.getCss("--service-nav-left"),entityNavTop:V.getCss("--entity-nav-top"),entityNavLeft:V.getCss("--entity-nav-left")})}function n(){document.documentElement.style.setProperty("--screen-height",`${window.innerHeight}px`),document.documentElement.style.setProperty("--screen-width",`${window.innerWidth}px`)}function o(){}function i(t,e=(t?t.path:"")){!function(){V.getState("serviceNav")||(Chat.launch(),Data.launch(),Marketplace.launch(),Media.launch(),User.launch());V.getSetting("demoContent")&&(async()=>{for(let t=0;t<DemoContent.mongoArr.length;t++)await V.setEntity(DemoContent.mongoArr[t])})()}(),V.getNode("background")||(Background.launch(),Haze.launch(),Feature.launch(),Header.launch(),Button.launch(),Page.launch()),function(){if(!V.getState("activeEntity")){const t=V.getCookie("last-active-address"),e=V.getCookie("last-active-uphrase");t?Join.draw("authenticate"):e?(async()=>{const t=await V.getEntity(V.castJson(e));V.setState("activeEntity",t.data[0]),Join.draw("new entity was set up")})():Join.launch()}}(),V.castRoute(e).then((t,e=t.status,n=t.data[0])=>{["home"].includes(e)?Marketplace.draw():["market","market category"].includes(e)?Marketplace.draw(n):["media","media category"].includes(e)?Media.draw(n):["data"].includes(e)?Data.draw(n):["user profile"].includes(e)?User.draw(n):["user account"].includes(e)?Account.draw(n):["user entities"].includes(e)?EntityList.draw(n):["user settings"].includes(e)?Settings.draw(n):["chat everyone"].includes(e)?Chat.draw(n):["profile"].includes(e)&&Profile.draw(n)})}return{launch:async function(){await async function(){V.getSetting("useBuilds")?(await Promise.all([V.setStylesheet("/css/builds/v.min.css")]),console.log("*** css builds loaded ***")):(await Promise.all([V.setStylesheet("/css/src/0_0_variables.css"),V.setStylesheet("/css/src/1_0_reset-normalize.css"),V.setStylesheet("/css/src/1_1_reset.css"),V.setStylesheet("/css/src/2_0_typography.css"),V.setStylesheet("/css/src/2_2_color.css"),V.setStylesheet("/css/src/3_0_utilities.css"),V.setStylesheet("/css/src/4_0_components.css"),V.setStylesheet("/css/src/8_0_overrides.css"),V.setStylesheet("/css/src/9_0_leaflet.css")]),console.log("*** css source files loaded ***"))}(),await async function(){V.getSetting("useBuilds")||(await Promise.all([V.setScript("/theme/src/canvas/components.js"),V.setScript("/theme/src/canvas/background.js"),V.setScript("/theme/src/canvas/haze.js"),V.setScript("/theme/src/canvas/feature.js"),V.setScript("/theme/src/canvas/header.js"),V.setScript("/theme/src/canvas/page.js"),V.setScript("/theme/src/modal/components.js"),V.setScript("/theme/src/modal/modal.js"),V.setScript("/theme/src/interaction/components.js"),V.setScript("/theme/src/interaction/button.js"),V.setScript("/theme/src/interaction/form.js"),V.setScript("/theme/src/interaction/join.js"),V.setScript("/theme/src/navigation/components.js"),V.setScript("/theme/src/navigation/navigation.js")]),console.log("*** theme source scripts loaded ***")),V.getSetting("useBuilds")?(await Promise.all([V.setScript("/plugins/builds/vplugins.min.js")]),console.log("*** plugins builds loaded ***")):(await Promise.all([V.setScript("/plugins/src/account/components.js"),V.setScript("/plugins/src/account/account.js"),V.setScript("/plugins/src/entity/components.js"),V.setScript("/plugins/src/entity/editable.js"),V.setScript("/plugins/src/entity/display.js"),V.setScript("/plugins/src/entity/settings.js"),V.setScript("/plugins/src/entity/entitylist.js"),V.setScript("/plugins/src/chat/components.js"),V.setScript("/plugins/src/chat/chat.js"),V.setScript("/plugins/src/map/map.js"),V.setScript("/plugins/src/google/google.js"),V.setScript("/plugins/src/data/components.js"),V.setScript("/plugins/src/data/data.js"),V.setScript("/plugins/src/marketplace/components.js"),V.setScript("/plugins/src/marketplace/marketplace.js"),V.setScript("/plugins/src/media/components.js"),V.setScript("/plugins/src/media/media.js")]),console.log("*** plugins source scripts loaded ***")),V.setNode("body",""),V.getSetting("demoContent")&&(await Promise.all([V.setScript("/assets/demo-content/demo-content.js")]),console.log("*** demo content loaded ***"))}(),V.setPipe(e,o,n,t)()},draw:function(t){(function(t){return Promise.resolve(t)})(t).then(t=>{i(t)})}}}(),CanvasComponents=function(){"use strict";return V.setStyle({"list > *:last-child":{"padding-bottom":"160px"},"card__top-left":{width:"25%"},"card__bottom-left":{display:"grid","justify-items":"center","text-align":"center",width:"25%"},"card__top-right":{width:"69%"},"card__bottom-right":{width:"69%"},card__unit:{width:"100%"},card__container:{"max-width":"360px","flex-wrap":"wrap"}}),{notFound:function(t){return V.setNode({t:"p",c:"pxy",h:V.i18n("No "+t+" found","app","not found")})},background:function(){return V.setNode({tag:"background",id:"background",classes:"background fixed w-screen",setStyle:{background:{background:"rgba(211,232,235,1)",height:"100vh","z-index":-2}}})},haze:function(){return V.setNode({tag:"haze",classes:"haze fixed w-screen bkg-white hidden",setStyle:{haze:{top:0,height:"45vh","z-index":-1}}})},feature:function(){const t=V.getState("page").featureDimensions;return V.setNode({tag:"feature",classes:"feature fixed hidden",setStyle:{feature:{top:"var(--page-position-top-selected)",height:t.height+"px",width:t.width+"px"}}})},balance:function(){const t=V.getState("screen");return V.setNode({tag:"balance",classes:"balance fixed cursor-pointer txt-anchor-mid",y:t.width>800?{top:"12px",left:"12px"}:{top:"2px",left:"2px"}})},interactions:function(){const t=V.getState("screen");return V.setNode({tag:"interactions",classes:"interactions fixed",setStyle:{interactions:{top:t.width>800?"23px":"11px",right:0,width:"45%"}},html:{tag:"ul",classes:"flex items-center justify-end"}})},handle:function(){return V.setNode({tag:"handle",classes:"handle",setStyle:{handle:{"padding-top":"12px",height:"26px",display:"block"}},html:{tag:"div",classes:"handle__bar rounded-full bkg-offblack",setStyle:{handle__bar:{"margin-left":"auto","margin-right":"auto",height:"4px",width:"5%","max-width":"40px"}}}})},topSlider:function(){return V.setNode({tag:"topslider"})},slider:function(){return V.castNode({tag:"slider",classes:"flex overflow-x-scroll list-none pb-s"})},listings:function(){return V.setNode({tag:"listings"})},list:function(t){const e=V.setNode({tag:"list",classes:"list flex flex-wrap content-start justify-evenly overflow-y-scroll list-none h-full"});return"narrow"==t&&(e.style["max-width"]="380px",e.style.margin="0 auto"),e},card:function(t,e){return V.setNode({t:"li",c:"pxy w-screen max-w-380",h:{t:"card",c:"card__container flex card-shadow rounded bkg-white pxy",h:e?[{t:"h2",c:"w-full font-bold pxy",h:V.i18n(e,"user profile","card title")},t]:t}})},header:function(){return V.setNode({tag:"header"})},page:function(){return V.setNode({tag:"page",classes:"page fixed w-screen bkg-white pill-shadow overflow-hidden",setStyle:{page:{bottom:0,height:"var(--page-position-peek)"}}})},content:function(){return V.setNode({tag:"content"})},topContent:function(){return V.setNode({tag:"topcontent"})}}}(),Feature=function(){"use strict";function t(t){return{$content:"object"==typeof t?t:t.content?t.content:void 0,fade:t.fade}}function e(t){const e=V.getNode("feature");"out"!=t.fade?("in"==t.fade||t.$content)&&(e.innerHTML="",V.setNode(e,t.$content),V.setAnimation("feature","fadeIn")):V.setAnimation("feature","fadeOut")}return{launch:function(){V.setNode("body",CanvasComponents.feature())},draw:function(n){V.setPipe(t,e)(n)}}}(),Haze=function(){"use strict";function t(t){return t}function e(t){if(t&&"out"==t.fade)return V.setState("header",{isHazed:!1}),void V.setAnimation("haze","fadeOut",{delay:.1,duration:1});1!=V.getState("header").isHazed&&(V.setState("header",{isHazed:!0}),V.setAnimation("haze","fadeIn",{delay:2,duration:3}))}return{launch:function(){V.setNode("body",CanvasComponents.haze())},draw:function(n){V.setPipe(t,e)(n)}}}(),Header=function(){"use strict";function t(t){return t}function e(){}return{launch:function(){const t=CanvasComponents.header(),e=CanvasComponents.balance(),n=NavComponents.entityNav(),o=NavComponents.userNav(),i=NavComponents.serviceNav(),a=CanvasComponents.interactions();V.setNode(t,[e,n,o,i,a]),V.setNode("body",t)},draw:function(n){V.setPipe(t,e)(n)}}}(),Page=function(){"use strict";const t={};function e(e){e&&(0!=e.reset&&(t.$topcontent.innerHTML="",t.$topslider.innerHTML="",t.$listings.innerHTML=""),e.topcontent&&V.setNode(t.$topcontent,e.topcontent),e.topslider&&V.setNode(t.$topslider,e.topslider),e.listings&&V.setNode(t.$listings,e.listings),e.position&&o(e.position,e.scroll,e.haze),e.pos&&o(e.pos,e.scroll,e.haze))}function n(t,e){V.setAnimation(".handle__bar",{width:t+"%"}),V.setAnimation("handle",{height:e+"px"})}function o(e,o,i){const a=V.getNode("list"),s=V.getNode("page"),r=V.getState("page"),c=V.getState("screen");"bottom"==o&&(a.scrollTop=a.scrollHeight);const l=function(t){const e=V.getState("page"),n=V.getState("active");switch(t){case"top":return n&&n.navItem?e.topSelectedCalc:e.topCalc;case"feature":return e.featureCalc;case"peek":return e.peek;default:return e.closed}}(e);l!=r.height&&(V.setAnimation(t.$page,{height:l+"px"},{duration:3}).then(()=>{a&&!o&&(a.scrollTop=0)}),"top"==e?(c.width<800&&(Haze.draw(),s.classList.remove("pill-shadow")),Feature.draw({fade:"out"}),n(7,22)):"feature"==e?(c.width<800&&s.classList.remove("pill-shadow"),c.width<800&&(null==i||0!=i)&&Haze.draw(),n(7,22),s.classList.remove("pill-shadow")):"closed"==e?(Haze.draw({fade:"out"}),Feature.draw({fade:"out"}),n(5,35),s.classList.add("pill-shadow")):"peek"==e&&(Haze.draw({fade:"out"}),Feature.draw({fade:"out"}),n(5,25),s.classList.add("pill-shadow")),V.setState("page",{height:l}))}return{launch:function(){!function(){const e=CanvasComponents.page(),n=CanvasComponents.handle(),o=CanvasComponents.content(),i=CanvasComponents.topContent(),a=CanvasComponents.topSlider(),s=CanvasComponents.listings();function r(t){V.setState("flick",{startX:t.changedTouches[0].clientX}),V.setState("flick",{startY:t.changedTouches[0].clientY})}function c(t){V.setState("flick",{endX:t.changedTouches[0].clientX}),V.setState("flick",{endY:t.changedTouches[0].clientY});const e=V.getNode("list");let n=!0;e&&e.scrollTop>0&&"listings"==t.currentTarget.localName&&(n=!1);const o=V.getState("page"),i=V.getState("flick");Math.abs(i.startX-i.endX)<100&&i.startY>i.endY+15?o.height==o.peek||o.height==o.featureCalc?Page.draw({position:"top",reset:!1}):o.height==o.closed&&Page.draw({position:"peek",reset:!1}):n&&Math.abs(i.startX-i.endX)<100&&i.startY<i.endY-15&&(o.height==o.peek?(Page.draw({position:"closed",reset:!1}),Navigation.draw()):(o.height==o.featureCalc||o.height>=o.topCalc)&&Page.draw({position:"peek",reset:!1}))}n.addEventListener("click",(function(){const t=V.getState("page");t.height==t.closed?Page.draw({position:"peek",reset:!1}):t.height==t.peek?Page.draw({position:"top",reset:!1}):(t.height==t.featureCalc||t.height>=t.topCalc)&&(Navigation.draw(),Page.draw({position:"closed",reset:!1}))})),n.addEventListener("touchstart",r),n.addEventListener("touchend",c),i.addEventListener("touchstart",r),i.addEventListener("touchend",c),a.addEventListener("touchstart",r),a.addEventListener("touchend",c),s.addEventListener("touchstart",r),s.addEventListener("touchend",c),V.setNode(o,[i,a,s]),V.setNode(e,[n,o]),V.setNode("body",e),t.$page=V.getNode("page"),t.$topcontent=V.getNode("topcontent"),t.$topslider=V.getNode("topslider"),t.$listings=V.getNode("listings")}()},draw:function(t){return Promise.resolve(e(t))}}}(),ModalComponents=function(){"use strict";window.addEventListener("keyup",(function(t){13==(window.event?t.keyCode:t.which)&&V.getNode("#sign-transaction")&&l(t)}));V.setStyle({modal:{top:"0",right:"0",bottom:"0",left:"0",background:"rgba(0,0,0,0.8)"},modal__content:{background:"white",width:"75vw","max-width":"500px",height:"46vh",margin:"14vh auto",padding:"0.5rem"},modal__close:{position:"absolute",right:"1rem",top:"1rem","text-decoration":"none",color:"white"},modal__uphrase:{color:"red"},"modal-pos-1":{top:"5vh"},"modal-pos-2":{top:"10vh"},"modal-pos-3":{top:"15vh"}});const t="relative bkg-button txt-button font-medium cursor-pointer txt-center pxy-1",e="relative cursor-pointer txt-center";function n(){V.setNode(".modal","clear")}function o(t){t.stopPropagation()}function i(){const e=InteractionComponents.formField("uPhrase"),n=V.cN({t:"div",c:t+" modal-pos-1",k:a,h:V.i18n("Use key","modal")});V.sN(".modal__content",""),V.setNode(".modal__content",[e,n])}function a(){V.getEntity(V.getNode("#loginform__uphrase").value).then(t=>{f(t)})}function s(){const e=InteractionComponents.formField("title"),n=V.cN({t:"div",c:t,k:r,h:V.i18n("Name profile","modal")}),o=V.sN({t:"div",c:"joinform__response pxy txt-red"});V.sN(".modal__content",""),V.setNode(".modal__content",[e,o,n])}function r(t){t.stopPropagation(),t.target.removeEventListener("click",r,!1),t.target.innerHTML=V.i18n("Joining ... ","modal"),V.getNode(".joinform__response").innerHTML="";const e={title:V.getNode("#plusform__title").value,role:"member",evmAddress:V.getState("activeAddress")};V.setState("activeEntity","clear"),console.log("about to set entity: ",e),V.setEntity(e).then(e=>{e.success?(console.log("response: ",e),V.setCache("all","clear"),f(e)):(console.log("response: ",e),t.target.addEventListener("click",r),t.target.innerHTML=V.i18n("Name profile","modal"),V.getNode(".joinform__response").innerHTML=e.message)})}function c(t){t.stopPropagation(),Join.draw("authenticate")}function l(t){t.stopPropagation();const e=V.getState("active").transaction;V.setTransaction(e).then(t=>{t.success?(Modal.draw("transaction successful"),Account.drawHeaderBalance()):(Modal.draw("error"),console.log(t))}).catch(t=>{console.error(t),Modal.draw()})}function d(){const t=V.getState("activeEntity"),e=V.getState("activeAddress");"EVM"==V.getSetting("transactionLedger")&&V.setEntity(t.fullId,{field:"evmCredentials.address",data:e,auth:V.getCookie("last-active-uphrase").replace(/"/g,"")}).then(()=>{Join.draw("authenticate")})}function u(t){t.stopPropagation(),window.open("https://metamask.io/download.html","_blank")}function p(){V.setCookie("last-active-address","clear"),V.setCookie("last-active-uphrase","clear"),window.location.href="/"}function f(t){if(t.success)V.setState("activeEntity",t.data[0]),Join.draw("new entity was set up");else{const e=V.getNode("#loginform__uPhrase")||V.getNode("#plusform__title");e.value="",e.setAttribute("placeholder",V.i18n(t.status,"placeholder"))}}function g(){return V.cN({t:"div",c:"modal__content relative",k:o})}return{modal:function(){return V.cN({t:"modal",c:"modal fixed",h:{t:"div",c:"modal__close",h:(t="close",V.i18n(t,"modal components",e||"modal content")+" "),k:n},k:n});var t,e},modalContent:g,simpleMessage:function(t){const e=g(),n=V.cN({t:"p",h:V.i18n(t,"modal")});return V.setNode(e,n),e},getMetaMask:function(){const e=g(),n=V.cN({t:"p",c:"txt-center",h:V.i18n("Enable a crypto wallet in your browser, for example","modal")+' <a href="https://metamask.io/download.html" target="_blank">MetaMask</a>'}),o=V.cN({t:"div",c:"mt-r mb-r ml-auto mr-auto",y:{width:"108px"},h:{t:"img",src:"/assets/img/metamask-fox.png"}}),i=V.cN({t:"div",c:t,k:u,h:V.i18n("Get MetaMask","modal")});return V.setNode(e,[n,o,i]),e},confirmTransaction:function(e){const n=e.data[0],o=g(),i=V.cN({t:"p",c:"modal__p",h:`<p>Amount: ${n.amount}</p>\n      <p>Fee: ${n.feeAmount}</p>\n      <p>Contribution: ${n.contribution}</p>\n      <p>Total: ${n.txTotal}</p>`}),a=V.cN({t:"div",i:"sign-transaction",c:t+" modal-pos-1",k:l,h:V.i18n("Sign Transaction","modal")});return V.setNode(o,[i,a]),o},web3Join:function(){const n=g(),o=V.cN({t:"div",c:t+" modal-pos-1",k:c,h:V.i18n("Connect wallet","modal")}),a=V.cN({t:"p",c:e+" modal-pos-2",k:s,h:V.i18n("Name new profile only","modal")}),r=V.cN({t:"p",c:e+" modal-pos-3",k:i,h:V.i18n("Manage profile with key","modal")});return V.setNode(n,[o,a,r]),n},web2Join:function(){const n=g(),o=V.cN({t:"div",c:t+" modal-pos-1",k:s,h:V.i18n("Name new profile","modal")}),a=V.cN({t:"p",c:e+" modal-pos-2",k:i,h:V.i18n("Manage profile with key","modal")});return V.setNode(n,[o,a]),n},disconnect:function(){const e=g(),n=V.cN({t:"div",c:t+" modal-pos-1",k:p,h:V.i18n("Confirm Disconnect","modal")});return V.setNode(e,n),e},mapAddress:function(){const n=g(),o=V.cN({t:"div",c:t+" modal-pos-1",k:d,h:V.i18n("Use current profile","modal")}),i=V.cN({t:"p",c:e+" modal-pos-2",k:s,h:V.i18n("Name new profile","modal")});return V.setNode(n,[o,i]),n},entityFound:function(t,e,n){const o=g(),i=V.cN({t:"div",c:"txt-center pxy",h:[{t:"p",h:V.i18n("Welcome","modal")},{t:"p",c:"font-medium fs-l pxy",h:t.fullId}]}),a=V.cN({t:"div",c:"txt-center",h:[{t:"p",c:"pxy",h:V.i18n("Click to copy the key and store it safely elsewhere","modal")},UserComponents.caseUphraseNode(t.private.uPhrase,"txt-red fs-l"),{t:"p",c:"pxy",h:V.i18n("You'll need this key to manage this profile","modal")}]});let s;const r=t.balance;return s=r?V.cN({t:"p",c:"modal__details",h:`\n        ${n} ${V.i18n("Live Balance","modal")}: ${r.liveBalance}<br>\n        ${e}: ${r.coinBalance}<br>\n        `}):V.cN({t:"p",h:V.i18n("Sorry, account details could not be retrieved","modal")}),V.setNode(o,[i,a]),o},entityNotFound:function(){const n=g(),o=V.cN({t:"div",c:t+" modal-pos-1",k:s,h:V.i18n("Name new profile","modal")}),i=V.cN({t:"p",c:e+" modal-pos-2",k:d,h:V.i18n("Use active profile","modal")}),a=V.cN({t:"p",c:"modal-pos-3 relative txt-center",h:V.i18n("Naming your profile creates a new entity for your address. An entity can be anything you want to make visible in the network.","modal")});return V.getState("activeEntity")?V.setNode(n,[o,i,a]):V.setNode(n,[o,a]),n}}}(),Modal=function(){"use strict";return{draw:function(t){!function(t){const e=ModalComponents.modal();if("entity found"==t){const t=V.getState("activeEntity"),n=V.getSetting("coinTicker"),o=V.getSetting("tokenTicker");V.setNode(e,ModalComponents.entityFound(t,n,o))}else if("entity not found"==t)V.setNode(e,ModalComponents.entityNotFound());else if("authenticate existing entity"==t)V.setNode(e,ModalComponents.mapAddress());else if("web3 provider not found"==t)V.setNode(e,ModalComponents.tempUser());else if("initialize web3 join"==t)V.setNode(e,ModalComponents.web3Join());else if("initialize web2 join"==t)V.setNode(e,ModalComponents.web2Join());else if("user denied auth"==t)V.setNode(e,ModalComponents.simpleMessage("Could not unlock wallet"));else if("could not get balance"==t)V.setNode(e,ModalComponents.simpleMessage("Could not get account balance. Is the network set correctly in your wallet? <br><br>Please set to KOVAN."));else if("wallet locked"==t)V.setNode(e,ModalComponents.simpleMessage("Connecting your wallet ... Seeing this message for long? You may have to unlock it manually. For example when using the MetaMask wallet."));else if("logged out"==t)V.setNode(e,ModalComponents.simpleMessage("You are logged out"));else if("disconnect"==t)V.setNode(e,ModalComponents.disconnect());else if("install metamask"==t)V.setNode(e,ModalComponents.getMetaMask());else if("please wait"==t)V.setNode(e,ModalComponents.simpleMessage("Please wait... requesting data"));else if("confirm transaction"==t){const t=V.getState("active").transaction;V.setNode(e,ModalComponents.confirmTransaction(t))}else"transaction sent"==t?V.setNode(e,ModalComponents.simpleMessage("Transaction has been sent to the network")):"transaction successful"==t?V.setNode(e,ModalComponents.simpleMessage("Transaction successful")):V.setNode(e,ModalComponents.simpleMessage("An error occured"));V.setNode(".modal","clear"),V.setNode("body",e)}(t)}}}(),Button=function(){"use strict";function t(e){e.target.removeEventListener("click",t,!1);const n=V.getNode("form"),o=n.getNode("#plusform__loc"),i={title:n.getNode("#plusform__title").value,role:V.getNavItem("active","serviceNav").use.role,location:o.value,lat:o.value&&o.getAttribute("lat")||void 0,lng:o.value&&o.getAttribute("lng")||void 0,description:n.getNode("#plusform__descr").value,unit:n.getNode("#plusform__unit").value,target:n.getNode("#plusform__target").value};V.getState("activeAddress")&&Object.assign(i,{receivingAddress:V.getState("activeAddress")}),V.getState("activeEntity")?(V.setEntity(i).then(t=>{t.success?(console.log(t.status),V.setCache("all","clear"),V.setCache(t.data[0].profile.role,"clear"),V.setBrowserHistory(t.data[0].path),Profile.draw(t.data[0].path),Form.draw("all",{fade:"out"}),Button.draw("all",{fade:"out"}),VMap.draw({type:"Feature",geometry:t.data[0].geometry,profile:t.data[0].profile,thumbnail:t.data[0].thumbnail,path:t.data[0].path}),V.setEntity(V.getState("activeEntity").fullId,{field:"adminOf",data:t.data[0].fullId,auth:V.getCookie("last-active-uphrase").replace(/"/g,"")})):(Form.draw("error",t),console.error(t.status))}),V.setCookie("last-form",void 0)):(V.setCookie("last-form",i),Join.draw("authenticate"))}function e(){const t=V.getNode("#search-input").value;if(t.length<2)return;const e={query:t};Marketplace.draw(V.getState("active").navItem,e)}function n(){Form.draw("all",{fade:"out"}),Button.draw("all",{fade:"out"}),Button.draw(V.getNavItem("active","serviceNav").use.button,{delay:1.5}),Page.draw({position:"peek",reset:!1})}function o(){Page.draw({position:"closed",reset:!1}),Form.draw("search")}function i(){Page.draw({position:"closed",reset:!1}),Form.draw(V.getNavItem("active","serviceNav").use.form)}function a(){V.setBrowserHistory("/me/transfers"),V.setState("active",{lastViewed:V.getNode(".pill__replace").innerHTML}),Canvas.draw({path:"/me/transfers"})}return{launch:function(){!function(){const s=InteractionComponents.filter(),r=InteractionComponents.searchBtn(),c=InteractionComponents.query(),l=InteractionComponents.plus(),d=InteractionComponents.set(),u=InteractionComponents.sendNav(),p=InteractionComponents.close();l.addEventListener("click",i),r.addEventListener("click",o),p.addEventListener("click",n),c.addEventListener("click",e),d.addEventListener("click",t),u.addEventListener("click",a),V.setNode("interactions > ul",[p,l,s,r,c,d,u])}()},draw:function(t,e){!function(t){let e="fadeIn",n=.2;t.options&&"out"==t.options.fade&&(e="fadeOut"),t.options&&t.options.delay&&(n=t.options.delay),t.btnArr.forEach(t=>{V.setAnimation("#"+t,e,{delay:n,duration:.5})})}(function(t,e){return{btnArr:"all"==t?["filter","search","plus","close","set","send","query"]:t.split(" "),options:e}}(t,e))}}}(),InteractionComponents=function(){"use strict";const t="cursor-pointer hidden pr-s";function e(t){V.setNode("#img-upload__label",V.i18n("uploading...","form field","placeholder")),V.castImageUpload(t).then(t=>{V.setNode("#img-upload__label",V.i18n("Change","form field","placeholder")),V.setNode("#img-upload__preview",""),V.setNode("#img-upload__preview",V.cN({t:"img",y:{"max-width":"25px","max-height":"20px","margin-left":"10px"},src:t.src}))})}function n(t,e){return V.cN({t:"div",c:"circle-1 flex justify-center items-center rounded-full bkg-white transition"+(e?" "+e:""),h:V.getIcon(t)})}return{filter:function(){return V.cN({t:"li",id:"filter",c:t,h:n("filter_list")})},searchBtn:function(){return V.cN({t:"li",id:"search",c:t,h:n("search")})},query:function(){return V.cN({t:"li",id:"query",c:t,h:n("search")})},plus:function(){return V.cN({t:"li",id:"plus",c:t,h:n("+")})},close:function(){return V.cN({t:"li",id:"close",c:t,h:n("close")})},set:function(){return V.cN({t:"li",id:"set",c:t,h:n("send")})},sendNav:function(){return V.cN({t:"li",id:"send",c:t,h:n("send")})},sendBtn:function(){return V.cN({t:"button",i:"send-message",c:"circle-1 flex justify-center items-center rounded-full bkg-white",h:V.cN({t:"span",c:"sendbtn",s:{sendbtn:{position:"relative",left:"1px",top:"1px",opacity:"0.75"}},h:V.getIcon("send")})})},form:function(){return V.setNode({tag:"form",classes:"form fixed w-screen hidden bkg-white pxy",setStyle:{form:{"padding-top":"calc(var(--page-position-top-selected) + 5px) !important",height:"100%","z-index":-1}}})},formField:function(t,e,n,o){const i={uPhrase:{label:"Key",inputId:"loginform__uphrase",attributes:{type:"password",autocomplete:"off"}},title:{label:"Title",inputId:"plusform__title",attributes:{autocomplete:"off"}},location:{label:"Location",inputId:"plusform__loc",attributes:{value:e,lat:n,lng:o,autocomplete:"off"}},description:{label:"Description and Links",inputId:"plusform__descr",multiline:!0},target:{label:"Target",inputId:"plusform__target",fieldClasses:"w-1/3 inline-block"},unit:{label:"Unit",inputId:"plusform__unit",fieldClasses:"w-1/3 inline-block"},search:{label:"Search",inputId:"search-input"}};function a(){this.closest(".field").classList+=" field--static field--focus"}function s(){const t=this.closest(".field").classList;this.value||t.remove("field--static"),t.remove("field--focus")}const r=V.cN({t:"div",c:"field__input-container"}),c=V.cN({t:"div",c:"field__label-wrapper",h:{t:"label",c:"field__label label-primary",h:{t:"span",c:"label__content",h:i[t].label}}}),l=V.cN({t:"input",c:"field__input",id:i[t].inputId,e:{focus:a,blur:s},a:i[t].attributes||{value:e}}),d=V.cN({t:"textarea",c:"field__input auto-height",id:i[t].inputId,a:{row:"1"},h:e,e:{input:function(){this.style.height="1px",this.style.height=this.scrollHeight+"px"},focus:a,blur:s}});i[t].multiline?V.setNode(r,[c,d]):V.setNode(r,[c,l]);const u=i[t].fieldClasses||"",p=e?" field--static":"";return V.cN({t:"div",c:"field pxy "+u+p,h:{t:"div",c:"field__border",h:{t:"div",c:"field__internal",h:r}}})},formUploadImage:function(){return V.cN({t:"div",y:{padding:"16px","margin-left":"6px",display:"inline-flex","align-items":"center",position:"relative"},c:"field pxy w-30% border-shadow",h:[{t:"label",i:"img-upload__label",a:{for:"img-upload__file"},h:V.i18n("Image","form field","placeholder")},{t:"input",i:"img-upload__file",c:"hidden",a:{type:"file",accept:"image/*"},e:{change:e}},{t:"div",i:"img-upload__preview",y:{position:"absolute",right:"10px"}}]})},formSearchFilter:function(){return V.cN({t:"div",h:[{t:"p",c:"pxy",h:V.i18n("Enter a title or city name","app")}]})},joinBtn:function(){const t=V.getState("screen"),e="rgba("+t.buttonBkg+", 1)";return V.cN({t:"join",c:"fixed cursor-pointer txt-anchor-mid",y:t.width>800?{top:"12px",left:"12px"}:{top:"2px",left:"2px"},h:{tag:"svg",a:{width:t.width>800?"66px":"54px",viewBox:"0 0 36 36"},h:`<circle stroke-dasharray="100" transform ="rotate(-90, 18, 18) translate(0, 36) scale(1, -1)"\n                       stroke-dashoffset="-200" cx="18" cy="18" r="15.91549430918954" fill="${e}"\n                       stroke="${e}" stroke-width="2.7">\n                </circle>\n                <text class="font-medium fs-xs txt-button" x="50%" y="59%">Join</text>`}})},onboardingCard:function(){const t=V.getState("activeEntity"),e=V.getSetting("transactionLedger");if(t&&"EVM"==e){let e;const n=!!(t.balance&&t.balance.balance.liveBalance>0);return V.getState("activeAddress")?n||"member"!=t.profile.role?n&&"member"==t.profile.role?(e=V.castNode({tag:"div",c:"flex w-full items-center justify-evenly",html:"<p>👋 "+V.i18n("Verify with BrightID to receive VALUE basic income.","join","onboarding call to action")+"</p>"}),CanvasComponents.card(e)):"":(e=V.castNode({tag:"div",c:"flex w-full items-center justify-evenly",html:"<p>👋 "+V.i18n("Ask a friend to transfer 1 VALUE to progress your verification.","join","onboarding call to action")+"</p>"}),CanvasComponents.card(e)):(e=V.castNode({tag:"div",c:"flex w-full items-center justify-evenly",html:"<p>👋 "+V.i18n("Connect a crypto wallet","join","onboarding call to action")+"</p>"}),e.addEventListener("click",(function(){window.Web3Obj?Join.draw("authenticate existing entity"):Join.draw("install metamask")})),CanvasComponents.card(e))}return""}}}(),Form=function(){"use strict";return{draw:function(t,e){!function(t){if(t.fadeOut)V.getNode("form")&&V.setAnimation("form","fadeOut",{delay:.2,duration:1}).then(()=>{V.setNode("form","clear")});else if("invalid title"==t.status){const t=V.getNode("#plusform__title");t.setAttribute("placeholder",V.i18n("Please choose another title","placeholder","form error")),t.value="",t.className+=" border-error"}else if("could not attach geo data"==t.status){const t=V.getNode("#plusform__loc");t.setAttribute("placeholder",V.i18n("Could not attach geo data","placeholder","form error")),t.value="",t.className+=" border-error"}else V.setNode("body",t.$form),V.setAnimation("form","fadeIn",{delay:.2,duration:1}),Google.launch().then(()=>{Google.initAutocomplete("plusform")}),Button.draw("all",{fade:"out"}),Button.draw("search"==t.layout?"close query":"close set",{delay:1})}(function(t,e){if(e&&"out"==e.fade)return{fadeOut:!0};if("error"==t)return e;const n=InteractionComponents.form();if("new entity"==t){const t={title:void 0,role:void 0,location:void 0,lat:void 0,lng:void 0,description:void 0,unit:void 0,target:void 0},e=V.castJson(V.getCookie("last-form"));e&&(t.title=e.title,t.location=e.location,t.lat=e.lat,t.lng=e.lng,t.description=e.description,t.unit=e.unit,t.target=e.target),V.setNode(n,[InteractionComponents.formField("title",t.title),InteractionComponents.formField("location",t.location,t.lat,t.lng),InteractionComponents.formField("description",t.description),InteractionComponents.formField("target",t.target),InteractionComponents.formField("unit",t.unit),InteractionComponents.formUploadImage()])}else"search"==t?V.setNode(n,[InteractionComponents.formField("search"),InteractionComponents.formSearchFilter()]):V.setNode(n,[InteractionComponents.title(),InteractionComponents.desc()]);return{layout:t,$form:n}}(t,e))}}}(),Join=function(){"use strict";async function t(){const t=V.getState("activeAddress");return t?V.getEntity(t).then(async t=>{if(t.reset)return"entity not found";if(t.success){V.setState("activeEntity",t.data[0]);const e=await V.getEntityBalance(t.data[0]);return e.success?V.setState("activeEntity",{balance:{success:!0,balance:e.data[0]}}):V.setState("activeEntity",{balance:{success:!1,message:e.message.message.message}}),"entity found"}return"entity not found"}):"error"}return{launch:function(){if(!V.getNode("join")){V.setNode("balance > svg","clear"),V.setCookie("welcome-modal",1);const t=InteractionComponents.joinBtn();t.addEventListener("click",(function(){Join.draw("initialize join")})),V.setNode("header",t)}},draw:function(e){(async function(e){return window.Web3Obj&&"EVM"==V.getSetting("transactionLedger")?"initialize join"==e?e="initialize web3 join":e.includes("authenticate")?await V.setActiveAddress().then(async n=>{if(n.success){const n=await t();e.includes("existing entity")?(V.setCookie("welcome-modal",1),e="authenticate existing entity"):e=n}else e=n.status}):"new entity was set up"==e&&(V.getState("activeAddress")?e=await t():V.getState("activeEntity").fullId&&(e="entity found")):"Symbol"==V.getSetting("transactionLedger")?"initialize join"==e?e="web2 login":"new entity was set up"==e&&(V.setState("activeAddress",V.getState("activeEntity").symbolCredentials.address),e="entity found"):"initialize join"==e?e="initialize web2 join":"new entity was set up"==e&&(e="entity found"),e})(e).then(t=>{!function(t){if(console.log(t,new Date),"entity found"==t){V.setNode("join","clear");const e=V.getState("activeEntity").balance;e?e&&e.success?(Account.drawHeaderBalance(e.balance.balance),V.setNode(".modal","clear"),1==V.getCookie("welcome-modal")&&(Modal.draw(t),V.setCookie("welcome-modal",0))):Modal.draw("could not get balance"):(Account.drawHeaderBalance(),V.setNode(".modal","clear"),1==V.getCookie("welcome-modal")&&(Modal.draw(t),V.setCookie("welcome-modal",0)))}else"entity not found"==t?(V.sN("balance > svg","clear"),Join.launch(),Modal.draw(t)):"logged out"==t?(Join.launch(),Navigation.draw(),Modal.draw(t)):"user denied auth"==t?(Join.launch(),Navigation.draw(),Modal.draw(t)):(Navigation.draw(),Page.draw({position:"closed"}),Modal.draw(t))}(t)})}}}(),NavComponents=function(){"use strict";V.setStyle({pill:{height:"2.5rem",padding:"0 1.2rem","margin-right":"0.7rem"},pill__entity:{height:"2.5rem",padding:"0 1rem","margin-right":"0.7rem"},"pill--selected":{color:"rgba(var(--brandPrimary), 1)",border:"2px solid rgba(var(--brandPrimary), 1)"},"pill--user-online":{position:"relative",left:"-3px"},pill__placeholderimage:{position:"relative",bottom:"-5px"},pill__img:{position:"relative",left:"-10px",border:"2px solid white"},pill__initials:{position:"relative",right:"3px"},"entity-nav":{"padding-top":"4px","padding-bottom":"8px",top:"var(--entity-nav-top)",left:"var(--entity-nav-left)"},"user-nav":{"padding-top":"4px","padding-bottom":"8px",top:"var(--user-nav-top)",left:"var(--user-nav-left)",display:"none"},"service-nav":{"padding-top":"4px","padding-bottom":"28px",top:"var(--service-nav-top)",left:"var(--service-nav-left)"},"entity-nav__ul":{"padding-left":"3px"},"service-nav__ul":{"padding-left":"3px"},"user-nav__ul":{"padding-left":"3px"},"entity-nav__ul > *:last-child":{visibility:"hidden"},"service-nav__ul > *:last-child":{visibility:"hidden"},"user-nav__ul > *:last-child":{visibility:"hidden"}});return{pill:function(t){return V.cN({t:"li",c:"pill flex justify-center items-center rounded-full bkg-white pill-shadow cursor-pointer no-txt-select whitespace-no-wrap",a:{path:t.path||"/"},h:[{t:"span",h:V.i18n(t.title,"navigation","nav item")}]})},entityPill:function(t){const e=(t=>{const e=["rgba("+V.getState("screen").brandSecondary+", 1)"];if(t.tinyImage){return"url('"+V.castEntityThumbnail(JSON.parse(t.tinyImage)).src+"')"}return e[0]})(t);return V.cN({t:"li",c:(t.tinyImage?"pill__entity":"pill")+" flex justify-center items-center rounded-full bkg-white pill-shadow cursor-pointer no-txt-select whitespace-no-wrap",a:{path:t.path||"/",fullId:t.title+" "+t.tag,initials:t.initials},h:[{t:"div",c:"pill__img circle-0 rounded-full flex justify-center items-center cursor-pointer",a:{style:`background:${e}; background-position: center center; background-size: cover;`},h:{t:"div",c:"card__initials font-bold fs-s txt-white",h:e.includes("url")?"":'<svg class="pill__placeholderimage txt-white" xmlns="http://www.w3.org/2000/svg" height="30" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4z"/></svg>'}},{t:"span",c:"pill__initials",h:V.i18n(t.initials,"navigation","nav item")}]})},entityNav:function(){return V.cN({t:"entity-nav",c:"nav entity-nav fixed w-screen overflow-x-scroll"})},userNav:function(){return V.cN({t:"user-nav",c:"nav user-nav fixed w-screen overflow-x-scroll"})},serviceNav:function(){return V.cN({t:"service-nav",c:"nav service-nav fixed w-screen overflow-x-scroll"})},entityNavUl:function(){return V.cN({t:"ul",c:"entity-nav__ul flex items-center font-medium fs-rr"})},serviceNavUl:function(){return V.cN({t:"ul",c:"service-nav__ul flex items-center font-medium"})},userNavUl:function(){return V.cN({t:"ul",c:"user-nav__ul flex items-center font-medium"})}}}(),Navigation=function(){"use strict";function t(t){if(t.success){!t.data[0].which&&s();const n=NavComponents.serviceNavUl();n.addEventListener("click",o);const i=e(t.data[0].serviceNav,3);for(let t=0;t<i.length;t++){const e=NavComponents.pill(i[t]);V.setNode(n,e)}V.setNode(n,NavComponents.pill({title:""})),V.setNode("service-nav",""),V.setNode("service-nav",n);const a=NavComponents.entityNavUl();a.addEventListener("click",o);const r=e(t.data[0].entityNav,3);for(let t=0;t<r.length;t++){const e=NavComponents.entityPill(r[t]);V.setNode(a,e)}V.setNode(a,NavComponents.pill({title:"zzzzz"})),V.setNode("entity-nav",""),V.setNode("entity-nav",a);const c=NavComponents.userNavUl();c.addEventListener("click",o);const l=e(t.data[0].userNav,1);for(let t=0;t<l.length;t++){const e=NavComponents.pill(l[t]);V.setNode(c,e)}V.setNode(c,NavComponents.pill({title:"zzzzz"})),V.setNode("user-nav",""),V.setNode("user-nav",c)}const n=t.data[0].which;n&&function(t){const e=V.getNode('[path="'+t+'"]');V.setState("active",{navItem:e.getAttribute("path")});const n=e.closest(".nav"),o=n.localName;"user-nav"==o||V.getVisibility("entity-nav")||(n.style.display="block",V.setAnimation("user-nav","fadeOut",{duration:.1}),V.setAnimation("entity-nav","fadeIn",{duration:.2}),V.setAnimation("service-nav","fadeIn",{duration:.6}));"user-nav"!=o||V.getVisibility("user-nav")||(n.style.display="block",V.setAnimation("entity-nav","fadeOut",{duration:.1}),V.setAnimation("service-nav","fadeOut",{duration:.6}),V.setAnimation("user-nav","fadeIn",{duration:.2}));const s=V.getState("header");i(),function(t){const e=t.getElementsByClassName("pill__initials")[0];e&&(e.innerHTML=t.getAttribute("fullId"),e.previousSibling.style.display="none",e.classList.add("pill__replace"),e.classList.remove("pill__initials"));t.className+=" pill--selected",t.addEventListener("click",a,{once:!0})}(e);const r=e.getBoundingClientRect();(function(t,e,n,o){let i=" absolute font-medium";"entity-nav"==t&&(i+=" fs-rr");const a=e.cloneNode(!0);a.className+=i,a.style.left=n.left+"px",a.style.top=n.top+"px",V.getNode("body").appendChild(a),e.style.visibility="hidden",V.getNode(t+" > ul").prepend(e),V.setAnimation(a,{top:o.entityNavTop+4,left:o.entityNavLeft+3},{duration:2}).then(()=>{e.style.visibility="visible",a.remove()})})(o,e,r,s),function(t){const e=V.getNode(t+" > ul").childNodes,n=V.castJson(V.getCookie(t+"-order"));for(let t=0;t<e.length-1;t++){const o=e[t],i=o.getAttribute("path");o.classList.contains("pill--selected")&&(n[i].c?n[i].c+=1:n[i].c=1),n[i].l=t}V.setCookie(t+"-order",n)}(o);const c="service-nav"==o?"entity-nav":"service-nav";V.sA(c,{width:0},{duration:1}),V.setAnimation(o,{width:r.width+11,top:s.entityNavTop,left:s.entityNavLeft},{duration:1}),V.getNode(o).scrollLeft=0}(n)}function e(t,e){const n=Object.values(t).sort((function(t,e){return t.l-e.l})),o=n.slice(e).sort((function(t,e){return e.c-t.c}));return n.slice(0).splice(0,e).concat(o)}function n(t,e){for(const n in t)e.hasOwnProperty(n)||delete t[n];for(const n in e)t.hasOwnProperty(n)||(t[e[n].path]={title:e[n].title,tag:e[n].tag,initials:e[n].initials,path:e[n].path},e[n].tinyImage&&(t[e[n].path].tinyImage=e[n].tinyImage))}function o(t){t.stopPropagation();const e=t.target.closest("li");if(e){const t=e.getAttribute("path");V.setState("active",{navItem:t}),V.setBrowserHistory(t),V.getNavItem("active",["serviceNav","entityNav","userNav"]).draw(t)}}function i(){const t=document.getElementsByClassName("pill--selected");if(t.length)for(let e=0;e<t.length;e++){const n=t[e].getElementsByClassName("pill__replace")[0];n&&(n.innerHTML=t[e].getAttribute("initials"),n.previousSibling.style.display="flex",n.classList.add("pill__initials"),n.classList.remove("pill__replace")),t[e].removeEventListener("click",a),t[e].classList.remove("pill--selected")}}function a(t){t.stopPropagation(),s(),Page.draw({position:"closed",reset:!1})}function s(){const t=V.getState("header"),e=window.innerWidth;i(),Chat.drawMessageForm("clear"),V.setBrowserHistory("/"),V.getVisibility("user-nav")&&(V.setAnimation("user-nav","fadeOut",{duration:.1}).then(()=>{V.setAnimation("user-nav",{width:e})}),V.setAnimation("entity-nav","fadeIn",{duration:.2}),V.setAnimation("service-nav","fadeIn",{duration:.6})),V.setState("active",{navItem:!1}),V.getNode("entity-nav").scrollLeft=0,V.getNode("service-nav").scrollLeft=0,V.setAnimation("entity-nav",{width:e},{duration:1.5}),V.setAnimation("service-nav",{width:e,top:t.serviceNavTop,left:t.serviceNavLeft},{duration:2.5}),Form.draw("all",{fade:"out"}),Button.draw("all",{fade:"out"})}return{draw:function(e){t(function(t,e=("object"==typeof t?t.paths.entity:t)){const o=V.castJson(V.getCookie("entity-nav-order")||"{}");!V.getState("entityNav")&&V.setState("entityNav",{});const i=V.getState("entityNav");t&&t.tinyImage&&o[t.path]&&(o[t.path].tinyImage=JSON.stringify(t.tinyImage));for(const t in o)if(!i[t]){const e={title:o[t].title,tag:o[t].tag,initials:o[t].initials,path:o[t].path,draw:function(t){Profile.draw(t)}};o[t].tinyImage&&(e.tinyImage=o[t].tinyImage),V.setNavItem("entityNav",e)}if(t&&t.fullId&&!i[t.path]){const e={title:t.profile.title,tag:t.profile.tag,initials:V.castInitials(t.profile.title),path:t.path,draw:function(t){Profile.draw(t)}};t.tinyImage&&(e.tinyImage=JSON.stringify(t.tinyImage)),V.setNavItem("entityNav",e)}n(o,i),V.setCookie("entity-nav-order",o);const a=V.getNode('[path="'+e+'"]');if(a&&a.closest("header")&&!t.fullId)return{success:!1,status:"navigation does not need updating",data:[{which:e}]};const s=V.castJson(V.getCookie("service-nav-order")||"{}");n(s,V.getState("serviceNav")),V.setCookie("service-nav-order",s);const r=V.castJson(V.getCookie("user-nav-order")||"{}");return n(r,V.getState("userNav")),V.setCookie("user-nav-order",r),{success:!0,status:"navigation updated",data:[{which:e,entityNav:o,userNav:r,serviceNav:s,keep:5}]}}(e))}}}();